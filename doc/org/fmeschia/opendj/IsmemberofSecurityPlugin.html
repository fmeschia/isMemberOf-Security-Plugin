<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_60) on Sat May 09 17:47:21 PDT 2015 -->
<title>IsmemberofSecurityPlugin</title>
<meta name="date" content="2015-05-09">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="IsmemberofSecurityPlugin";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../org/fmeschia/opendj/package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/IsmemberofSecurityPlugin.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li>Next Class</li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/fmeschia/opendj/IsmemberofSecurityPlugin.html" target="_top">Frames</a></li>
<li><a href="IsmemberofSecurityPlugin.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.fmeschia.opendj</div>
<h2 title="Class IsmemberofSecurityPlugin" class="title">Class IsmemberofSecurityPlugin</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.opends.server.api.plugin.DirectoryServerPlugin&lt;org.fmeschia.opendj.server.IsmemberofSecurityPluginCfg&gt;</li>
<li>
<ul class="inheritance">
<li>org.fmeschia.opendj.IsmemberofSecurityPlugin</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">IsmemberofSecurityPlugin</span>
extends org.opends.server.api.plugin.DirectoryServerPlugin&lt;org.fmeschia.opendj.server.IsmemberofSecurityPluginCfg&gt;</pre>
<div class="block">The isMemberOf security plug-in implementation class. 
 
 This plug-in will prevent authenticated binds from obtaining information 
 (from the isMemberOf virtual attribute) about membership in groups that they 
 have no right upon (as inferred from the bind's ability to obtain the 
 member/uniqueMember attribute).
 
 There are three LDAP use cases that may leak undue information about group
 membership:
 
 1. Users request the isMemberOf attribute for an entry, and values of 
    this attribute show membership in groups that the user's bind has no
    right upon.
 2. Users compare the isMemberOf attribute of an entry with the DN name
    of a group that the user's bind has no right upon.
 3. Users search the directory without requesting the isMemberOf attribute
    directly, but they use the isMemberOf attribute in the filter clause
    to obtain list of members of groups that the user's bind has no right
    upon.
    
 This plug-in addresses both these information leakage cases. Its overarching
 goal is to make sure that a user can only see isMemberOf values that point
 to groups that the user can fetch members from. All other values are
 effectively made invisible, not comparable and not searchable. We call this
 the "visibility metaphor".</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../org/fmeschia/opendj/IsmemberofSecurityPlugin.html#IsmemberofSecurityPlugin()">IsmemberofSecurityPlugin</a></strong>()</code>
<div class="block">Default constructor.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>org.opends.server.api.plugin.PluginResult.PreParse</code></td>
<td class="colLast"><code><strong><a href="../../../org/fmeschia/opendj/IsmemberofSecurityPlugin.html#doPreParse(org.opends.server.types.operation.PreParseCompareOperation)">doPreParse</a></strong>(org.opends.server.types.operation.PreParseCompareOperation&nbsp;compareOperation)</code>
<div class="block">This is the hook point for any processing that should be done before the
 Directory Server parses the elements of a compare request.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>org.opends.server.api.plugin.PluginResult.PreParse</code></td>
<td class="colLast"><code><strong><a href="../../../org/fmeschia/opendj/IsmemberofSecurityPlugin.html#doPreParse(org.opends.server.types.operation.PreParseSearchOperation)">doPreParse</a></strong>(org.opends.server.types.operation.PreParseSearchOperation&nbsp;searchOperation)</code>
<div class="block">This is the hook point for any processing that should be done before 
 the Directory Server parses the elements of a search request.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../org/fmeschia/opendj/IsmemberofSecurityPlugin.html#initializePlugin(java.util.Set,%20org.fmeschia.opendj.server.IsmemberofSecurityPluginCfg)">initializePlugin</a></strong>(java.util.Set&lt;org.opends.server.api.plugin.PluginType&gt;&nbsp;pluginTypes,
                org.fmeschia.opendj.server.IsmemberofSecurityPluginCfg&nbsp;configuration)</code>
<div class="block">Performs any initialization necessary for this plug-in.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../org/fmeschia/opendj/IsmemberofSecurityPlugin.html#isConfigurationAcceptable(org.fmeschia.opendj.server.IsmemberofSecurityPluginCfg,%20java.util.List)">isConfigurationAcceptable</a></strong>(org.fmeschia.opendj.server.IsmemberofSecurityPluginCfg&nbsp;config,
                         java.util.List&lt;org.opends.messages.Message&gt;&nbsp;messages)</code>
<div class="block">Indicates whether the provided configuration is acceptable for this 
 plug-in.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>org.opends.server.api.plugin.PluginResult.IntermediateResponse</code></td>
<td class="colLast"><code><strong><a href="../../../org/fmeschia/opendj/IsmemberofSecurityPlugin.html#processSearchEntry(org.opends.server.types.operation.SearchEntrySearchOperation,%20org.opends.server.types.SearchResultEntry)">processSearchEntry</a></strong>(org.opends.server.types.operation.SearchEntrySearchOperation&nbsp;searchOperation,
                  org.opends.server.types.SearchResultEntry&nbsp;searchEntry)</code>
<div class="block">This is the hook point that allows to performs any necessary processing 
 before a search result entry is sent to a client.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_org.opends.server.api.plugin.DirectoryServerPlugin">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;org.opends.server.api.plugin.DirectoryServerPlugin</h3>
<code>doLDIFExport, doLDIFImport, doLDIFImportBegin, doLDIFImportEnd, doPostConnect, doPostDisconnect, doPostOperation, doPostOperation, doPostOperation, doPostOperation, doPostOperation, doPostOperation, doPostOperation, doPostOperation, doPostOperation, doPostOperation, doPostResponse, doPostResponse, doPostResponse, doPostResponse, doPostResponse, doPostResponse, doPostResponse, doPostResponse, doPostSynchronization, doPostSynchronization, doPostSynchronization, doPostSynchronization, doPreOperation, doPreOperation, doPreOperation, doPreOperation, doPreOperation, doPreOperation, doPreOperation, doPreOperation, doPreParse, doPreParse, doPreParse, doPreParse, doPreParse, doPreParse, doPreParse, doPreParse, doShutdown, doStartup, finalizePlugin, getPluginEntryDN, getPluginTypes, initializeInternal, invokeForInternalOperations, isConfigurationAcceptable, processIntermediateResponse, processSearchReference, processSubordinateDelete, processSubordinateModifyDN, setInvokeForInternalOperations</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="IsmemberofSecurityPlugin()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>IsmemberofSecurityPlugin</h4>
<pre>public&nbsp;IsmemberofSecurityPlugin()</pre>
<div class="block">Default constructor.</div>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="initializePlugin(java.util.Set, org.fmeschia.opendj.server.IsmemberofSecurityPluginCfg)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initializePlugin</h4>
<pre>public&nbsp;void&nbsp;initializePlugin(java.util.Set&lt;org.opends.server.api.plugin.PluginType&gt;&nbsp;pluginTypes,
                    org.fmeschia.opendj.server.IsmemberofSecurityPluginCfg&nbsp;configuration)
                      throws org.opends.server.config.ConfigException,
                             org.opends.server.types.InitializationException</pre>
<div class="block">Performs any initialization necessary for this plug-in.  This will
 be called as soon as the plug-in has been loaded and before it is
 registered with the server.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code>initializePlugin</code>&nbsp;in class&nbsp;<code>org.opends.server.api.plugin.DirectoryServerPlugin&lt;org.fmeschia.opendj.server.IsmemberofSecurityPluginCfg&gt;</code></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>org.opends.server.config.ConfigException</code></dd>
<dd><code>org.opends.server.types.InitializationException</code></dd></dl>
</li>
</ul>
<a name="isConfigurationAcceptable(org.fmeschia.opendj.server.IsmemberofSecurityPluginCfg, java.util.List)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isConfigurationAcceptable</h4>
<pre>public&nbsp;boolean&nbsp;isConfigurationAcceptable(org.fmeschia.opendj.server.IsmemberofSecurityPluginCfg&nbsp;config,
                                java.util.List&lt;org.opends.messages.Message&gt;&nbsp;messages)</pre>
<div class="block">Indicates whether the provided configuration is acceptable for this 
 plug-in.</div>
</li>
</ul>
<a name="processSearchEntry(org.opends.server.types.operation.SearchEntrySearchOperation, org.opends.server.types.SearchResultEntry)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>processSearchEntry</h4>
<pre>public&nbsp;org.opends.server.api.plugin.PluginResult.IntermediateResponse&nbsp;processSearchEntry(org.opends.server.types.operation.SearchEntrySearchOperation&nbsp;searchOperation,
                                                                                org.opends.server.types.SearchResultEntry&nbsp;searchEntry)</pre>
<div class="block">This is the hook point that allows to performs any necessary processing 
 before a search result entry is sent to a client. 
 In order to minimize performance impact, the whole logic is skipped
 unless the isMemberOf attribute is present in the candidate entry.
 If the attribute is present, each value is interpreted as the DN of a
 group, and the canReadMembers() method is called to check whether the
 user can read the members of that group. If it turns out that the user
 can't, the value is removed from the attribute of the candidate entry.</div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code>processSearchEntry</code>&nbsp;in class&nbsp;<code>org.opends.server.api.plugin.DirectoryServerPlugin&lt;org.fmeschia.opendj.server.IsmemberofSecurityPluginCfg&gt;</code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>searchOperation</code> - The search operation with which the search entry 
 is associated.</dd><dd><code>searchEntry</code> - The search result entry that is to be sent to the 
 client. Its contents may be altered by the plugin if necessary.</dd></dl>
</li>
</ul>
<a name="doPreParse(org.opends.server.types.operation.PreParseCompareOperation)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>doPreParse</h4>
<pre>public&nbsp;org.opends.server.api.plugin.PluginResult.PreParse&nbsp;doPreParse(org.opends.server.types.operation.PreParseCompareOperation&nbsp;compareOperation)
                                                              throws org.opends.server.types.CanceledOperationException</pre>
<div class="block">This is the hook point for any processing that should be done before the
 Directory Server parses the elements of a compare request.
 In order to avoid information leakage, the compare operation is checked
 to see if it involves the isMemberOf attribute. If so, only operations
 involving groups on which the user has permission to see the members are
 permitted. Comparisons involving groups on which the user has no
 permissions will result in an error being returned to the client.</div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code>doPreParse</code>&nbsp;in class&nbsp;<code>org.opends.server.api.plugin.DirectoryServerPlugin&lt;org.fmeschia.opendj.server.IsmemberofSecurityPluginCfg&gt;</code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>compareOperation</code> - The compare operation that has been requested.</dd>
<dt><span class="strong">Returns:</span></dt><dd>Information about the result of the plugin processing.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>org.opends.server.types.CanceledOperationException</code></dd></dl>
</li>
</ul>
<a name="doPreParse(org.opends.server.types.operation.PreParseSearchOperation)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>doPreParse</h4>
<pre>public&nbsp;org.opends.server.api.plugin.PluginResult.PreParse&nbsp;doPreParse(org.opends.server.types.operation.PreParseSearchOperation&nbsp;searchOperation)
                                                              throws org.opends.server.types.CanceledOperationException</pre>
<div class="block">This is the hook point for any processing that should be done before 
 the Directory Server parses the elements of a search request.
 In order to avoid information leakage, the filter used by the
 search operation is parsed and re-written, so that any filter element 
 involving an equality comparison of isMemberOf with a group that
 the user has no right to see, is replaced with a logical false value.
 This is effectively equivalent to making the prohibited isMemberOf
 values invisible from filters.
 Note that equality comparisons are the only possible ones for isMemberOf
 (no other matching rule is defined in the schema), so we can leave
 alone substring, presence and other comparisons involving isMemberOf,
 because OpenDJ will sanitize them anyway.</div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code>doPreParse</code>&nbsp;in class&nbsp;<code>org.opends.server.api.plugin.DirectoryServerPlugin&lt;org.fmeschia.opendj.server.IsmemberofSecurityPluginCfg&gt;</code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>searchOperation</code> - The search operation that has been requested.</dd>
<dt><span class="strong">Returns:</span></dt><dd>Information about the result of the plugin processing.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>org.opends.server.types.CanceledOperationException</code></dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../org/fmeschia/opendj/package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/IsmemberofSecurityPlugin.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li>Next Class</li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/fmeschia/opendj/IsmemberofSecurityPlugin.html" target="_top">Frames</a></li>
<li><a href="IsmemberofSecurityPlugin.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
